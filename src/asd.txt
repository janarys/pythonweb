import { Editor } from "@monaco-editor/react";
import "./App.css";
import * as Sk from "skulpt";
import { useEffect, useRef } from "react";

function App() {
  const mypre: any = useRef(null);
  useEffect(() => {
    function outf(text: string) {
      if (mypre.current) {
        mypre.current.innerHTML = mypre.current.innerHTML + text;
      }
    }
    function builtinRead(x: any) {
      if (
        Sk.builtinFiles === undefined ||
        Sk.builtinFiles["files"][x] === undefined
      )
        throw "File not found: '" + x + "'";
      return Sk.builtinFiles["files"][x];
    }
    var prog = "print('asd')";
    mypre.current.innerHTML = "";
    Sk.pre = "output";
    Sk.configure({ output: outf, read: builtinRead });
    (Sk.TurtleGraphics || (Sk.TurtleGraphics = {})).target = "mycanvas";
    Sk.configure({ output: "" });
    const p = Sk.misceval.asyncToPromise(() => {
      return Sk.importMainWithBody("", false, prog);
    });
    p.then(
      function (mod: any) {
        console.log("success");
      },
      function (err: any) {
        console.log(err.toString());
      }
    );
  });
  return (
    <div className="App">
      <Editor defaultLanguage="python" height="90vh" />
      <div ref={mypre}>asd</div>
    </div>
  );
}

export default App;
